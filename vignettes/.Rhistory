plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
plot((y - 2 - t/20))
plot(mean((y - mean(y))[seq(i,N,by=12)]))
plot((y - mean(y))
)
plot(y-mean(y))
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*t/12),col='black'
)
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=0.5)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
seas_est2[i] <- mean((y - mean(y))[seq(i,N,by=12)])
seas_est3[i] <- mean((y - 2 - t/20)[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=1)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
seas_est2[i] <- mean((y - mean(y))[seq(i,N,by=12)])
seas_est3[i] <- mean((y - 2 - t/20)[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
lm(y~t)
param(lm(y~t))
x <- lm(y~t)
model <- lm(y~t)
model$coefficients[1]
model1 <- lm(y~1)
model2 <- lm(y~t)
model1$coefficients
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model1$coefficients[1] - t* model1$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
model <- lm(y~t)
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=5)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=5)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model1$coefficients[1] - t* model1$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
lines(1:12,seas_est3,col='green')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
lines(1:12,seas_est3,col='green')
lines(1:12,seas_est3,col='green',size=2)
lines(1:12,seas_est3,col='green',linewidth=2)
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=5)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model1$coefficients[1] - t* model1$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
seas_est3
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=5)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=1)
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=1)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/20 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/2 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
plot(y)
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
plot(t,y)
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
seas_est1[i] <- mean(y[seq(i,N,by=12)])
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-2,6))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est1,ylim=c(-3,3))
lines(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est2,col='red')
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est2,col='red',ty=e='l',ylim=c(-2,2))
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
y = 2 + t/5 + sin(2*pi*t/12) + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est2,col='red',type='l',ylim=c(-2,2))
lines(1:12,seas_est3,col='green')
lines(1:12,sin(2*pi*(1:12)/12),col='black')
N_yrs <- 10
N = 12 * N_yrs
t = seq(1, N, by=1)
true_season = sin(2*pi*t/12)
y = 2 + t/5 + true_season + rnorm(length(t),sd=0.2)
plot(t,y)
seas_est1 <- seas_est2 <- seas_est3 <- rep(0,12)
for(i in 1:12){
model1 <- lm(y~1)
model2 <- lm(y~t)
seas_est2[i] <- mean((y - model1$coefficients[1])[seq(i,N,by=12)])
seas_est3[i] <- mean((y -  model2$coefficients[1] - t* model2$coefficients[2])[seq(i,N,by=12)])
}
plot(1:12,seas_est2,col='red',type='l',ylim=c(-2,2))
lines(1:12,seas_est3,col='green')
lines(1:12,true_season,col='black')
source('/media/andrew/OLD_SAMSUNG/Andrew/Work/PostDoc Bristol/RCode/Archive-AIS/scripts/seasoning_tests.R')
parallel::detectCores
sst <- read.table(textConnection(getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat")),col.names = c("x","y"))
library(RCurl)
sst <- read.table(textConnection(getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat")),col.names = c("x","y"))
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>% textConnection() %>% read.table(col.names=c("x","y"))
library(dplyr)
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>% textConnection() %>% read.table(col.names=c("x","y"))
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table()) %>%
mutate(land = getURL("http://www.stat.missouri.edu/~wikle/SSTlandmask.dat") %>%
textConnection() %>%
read.table()[,1])
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table())
head(sst)
head(sst[,1:2])
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table()) %>%
mutate(land = (getURL("http://www.stat.missouri.edu/~wikle/SSTlandmask.dat") %>%
textConnection() %>%
read.table()[,1])) %>%
gather(date,z,-x,-y,-land) %>%
mutate(time = as.numeric(date)) %>%
select(-date) %>%
subset(x > 155 & x < 280 & y <14&land==0)
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table()) %>%
mutate(land = (getURL("http://www.stat.missouri.edu/~wikle/SSTlandmask.dat") %>%
textConnection() %>%
read.table())[,1])
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table()) %>%
mutate(land = (getURL("http://www.stat.missouri.edu/~wikle/SSTlandmask.dat") %>%
textConnection() %>%
read.table())[,1]) %>%
gather(date,z,-x,-y,-land) %>%
mutate(time = as.numeric(date)) %>%
select(-date) %>%
subset(x > 155 & x < 280 & y <14&land==0)
library(plyr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(EFDR)
library(doMC)
library(foreach)
library(RCurl)
sst <- getURL("http://www.stat.missouri.edu/~wikle/SSTlonlat.dat") %>%
textConnection() %>%
read.table(col.names = c("x","y")) %>%
cbind(getURL("http://www.stat.missouri.edu/~wikle/SST011970_032003.dat") %>%
textConnection() %>%
read.table()) %>%
mutate(land = (getURL("http://www.stat.missouri.edu/~wikle/SSTlandmask.dat") %>%
textConnection() %>%
read.table())[,1]) %>%
gather(date,z,-x,-y,-land) %>%
mutate(time = as.numeric(date)) %>%
select(-date) %>%
subset(x > 155 & x < 280 & y <14&land==0)
head(sst)
tail(sst)
q()
q()
X <- data.frame(x = c(1,1,1,2,2,2,3,4),y=rnorm(8))
library(dplyr)
g <- group_by(X,x)
xxx <- summarise(g,mean(y))
xxx
id <- c(1, 2, 3, 4, 5)
name <- c("name1", "name2", "name3", "name4", "name5")
position <- c("AAA", "BBB", "CCC", "AAA", "BBB")
salary <- c(20, 30, 40, 50, 60)
bonus <- c(1, 1, 1, NA, 1)
sti <- c(2, 3, 4, 5, 6)
lti <- c(6, 5, 4, 3, 2)
other <- c(10, 11, 12, 13, 14)
df <- data.frame(id, name, position, salary, bonus, sti, lti, other)
df_out <- ddply(df, .(position), numcolwise(summary))
g <- group_by(df,position)
summarise(g,summary)
summarise(g,summary(bonus))
df
summarise(g,summary(lti))
summarise(g, mean(lti))
summarise(g, numcolwise(summary)(lti))
summarise(g, t(summary(lti)))
summary(c(1,2,3,4))
summarise(g, stats = summary(lti))
summarise(g, stats = summary(lti)[1])
library(dplyr)
id <- c(1, 2, 3, 4, 5)
name <- c("name1", "name2", "name3", "name4", "name5")
position <- c("AAA", "BBB", "CCC", "AAA", "BBB")
salary <- c(20, 30, 40, 50, 60)
bonus <- c(1, 1, 1, NA, 1)
sti <- c(2, 3, 4, 5, 6)
lti <- c(6, 5, 4, 3, 2)
other <- c(10, 11, 12, 13, 14)
df <- data.frame(id, name, position, salary, bonus, sti, lti, other)
df_out <- ddply(df, .(position), numcolwise(summary))
library(plyr)
q()
library(plyr)
library(EFDR)
vignette()
vignette("EFDR")
vignette("EFDR_SST")
q()
setwd("/media/andrew/Windows/Users/azm/Dropbox/CurrentProjects/Wollongong/pkgs/EFDR/vignettes")
library(devtools)
document("..")
x = 4
x
x * 2
q()
n
q()
n
